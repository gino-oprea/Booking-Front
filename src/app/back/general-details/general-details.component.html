<legend style="margin-bottom: 10px;">{{getCurrentLabelValue('lblGeneralDetails')}}</legend>
<div class="row" style="height: 100%;">
  <div class="col-md-12" style="height: 100%;">
    <ul class="nav nav-tabs">
      <li (click)="selectTab('details')" [class.active]="tabs.details.active" style="cursor: pointer;">
        <a style="color: black"><i class="fa fa-file-text-o"></i> {{getCurrentLabelValue('lblDetails')}}</a>
      </li>
      <li (click)="selectTab('timeSettings')" [class.active]="tabs.timeSettings.active" style="cursor: pointer;">
        <a style="color: black;"><i class="fa fa-calendar-o"></i> {{getCurrentLabelValue('lblTimeSettings')}}</a>
      </li>
    </ul>
    <div [hidden]="!tabs.details.active" style="height: 95%;padding: 5px;">
      <div class="row" style="margin-right: 0px;height: 100%;">
        <div class="col-md-6" style="height: 100%;">
          <form class="form-horizontal" style="height: 100%" id="user-form" [formGroup]="genDetailsForm"
            (ngSubmit)="onSaveForm()">
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="name">{{getCurrentLabelValue('lblName')}}:</label>
              <div class="col-md-10">
                <input type="text" id="name" formControlName="name" [ngClass]="{'valid-control':genDetailsForm.controls['name'].valid,
                        'invalid-control':!genDetailsForm.controls['name'].valid}" class="form-control">
              </div>
            </div>

            <div class="form-group" style="height: 15%;">
              <label class="col-md-2 control-label" for="description_ro">Description RO:</label>
              <div class="col-md-10" style="height: 100%">
                <textarea id="description_ro" [ngClass]="{'valid-control':genDetailsForm.controls['description_ro'].valid,
                        'invalid-control':!genDetailsForm.controls['description_ro'].valid}"
                  formControlName="description_ro" type="text" class="form-control input-md"
                  style="height: 100%;padding: 3px;resize: none;"></textarea>
              </div>
            </div>

            <div class="form-group" style="height: 15%;">
              <label class="col-md-2 control-label" for="description_en">Description EN:</label>
              <div class="col-md-10" style="height: 100%">
                <textarea id="description_en" [ngClass]="{'valid-control':genDetailsForm.controls['description_en'].valid,
                                    'invalid-control':!genDetailsForm.controls['description_en'].valid}"
                  formControlName="description_en" type="text" class="form-control input-md"
                  style="height: 100%;padding: 3px;resize: none;"></textarea>
              </div>
            </div>

            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="category">{{getCurrentLabelValue('lblCategory')}}:</label>
              <div class="col-md-10">
                <!--<p-dropdown [options]="categories" formControlName="category" (onChange)="onChangeCategory($event)" [style]="{'width':'100%'}" [filter]="false"></p-dropdown>-->
                <select formControlName="category" style="height: 100%;width: 100%;"
                  (change)="onChangeCategory($event)">
                  <option *ngFor="let c of categories" [value]="c.id">
                    {{currentCulture == 'EN' ? c.value_EN : c.value_RO}}</option>
                </select>
              </div>
            </div>
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label"
                for="subcategory">{{getCurrentLabelValue('lblSubCategory')}}:</label>
              <div class="col-md-10">
                <!--<p-dropdown [options]="subcategories" formControlName="subcategory" [style]="{'width':'100%'}" [filter]="false"></p-dropdown>-->
                <select formControlName="subcategory" style="height: 100%;width: 100%;">
                  <option *ngFor="let s of subcategories" [value]="s.id">
                    {{currentCulture == 'EN' ? s.value_EN : s.value_RO}}</option>
                </select>
              </div>
            </div>
            <!-- Text input-->
            <!-- <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="country">{{getCurrentLabelValue('lblCountry')}}:</label>
              <div class="col-md-10">
                <p-dropdown [options]="countries" formControlName="country" [style]="{'width':'100%'}" [filter]="true" (onChange)="addressAutocomplete()"></p-dropdown>
              </div>
            </div> -->
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="county">Judet:</label>
              <div class="col-md-10">
                <p-dropdown [options]="counties" formControlName="county" [style]="{'width':'100%'}" [filter]="true"
                  (onChange)="onLoadCities(this.genDetailsForm.controls['county'].value)"></p-dropdown>
              </div>
            </div>
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="city">Localitate:</label>
              <div class="col-md-10">
                <p-dropdown [options]="cities" formControlName="city" [style]="{'width':'100%'}" [filter]="true">
                </p-dropdown>
              </div>
            </div>
            <!-- Text input-->
            <!-- <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="town">{{getCurrentLabelValue('lblTown')}}:</label>
              <div class="col-md-10">
                <input id="town" type="text" formControlName="town" [ngClass]="{'valid-control':genDetailsForm.controls['town'].valid,
                        'invalid-control':!genDetailsForm.controls['town'].valid}" class="form-control">
              </div>
            </div> -->
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="address">{{getCurrentLabelValue('lblAddress')}}:</label>
              <div class="col-md-10">

                <input id="address" type="text" formControlName="address" #address [ngClass]="{'valid-control':genDetailsForm.controls['address'].valid,
                        'invalid-control':!genDetailsForm.controls['address'].valid}" class="form-control">
              </div>
            </div>
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="email">Email:</label>
              <div class="col-md-10">
                <input id="email" type="text" formControlName="email" [ngClass]="{'valid-control':genDetailsForm.controls['email'].valid,
                        'invalid-control':!genDetailsForm.controls['email'].valid}" class="form-control">
              </div>
            </div>
            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="phone">{{getCurrentLabelValue('lblPhone')}}:</label>
              <div class="col-md-10">
                <input id="phone" type="text" formControlName="phone" [ngClass]="{'valid-control':genDetailsForm.controls['phone'].valid,
                        'invalid-control':!genDetailsForm.controls['phone'].valid}" class="form-control">
              </div>
            </div>

            <div class="form-group" style="height: 6%;">
              <label class="col-md-2 control-label" for="btnSubmit"></label>
              <div class="col-md-10">
                <button [disabled]="!genDetailsForm.valid" type="submit" id="btnSubmit"
                  class="btn btn-success from-control" style="width: 100%">
                  <i class="fa fa-save"></i> {{getCurrentLabelValue('lblSave')}}
                </button>
              </div>
            </div>
          </form>
        </div>
        <div class="col-md-6" style="height: 100%;">
          <div class="row" style="height: 8%;">
            <div class="col-md-12">
              <input id=file type="file" (change)="onUpload($event)" class="inputfile" />
              <label for="file" class="btn btn-primary" style="margin-bottom: 2px;"><i class="fa fa-upload"></i>
                {{getCurrentLabelValue('lblUploadImage')}}</label>
            </div>
          </div>

          <div class="row" style="height: 25%;">
            <div class="col-md-12" style="height: 100%!important; overflow: auto;">
              <ul *ngIf="images.length>0" class="imgList">
                <li *ngFor="let img of images; let i=index" style="padding-left: 1px;padding-right: 1px;">
                  <img [src]="'data:image/png;base64,'+img.img" (click)="onImageClick(img)"
                    style="cursor:pointer; height: auto;width: auto;max-height: 100px;max-width: 100%;">
                </li>
              </ul>
              <img *ngIf="images.length==0" [src]="COMP_IMG"
                style="height: auto;width: auto;max-height: 100px;max-width: 100%;">
            </div>
          </div>
          <br>
          <div class="row" style="height: 65%;">
            <div class="col-md-12" style="height: 100%;">
              <p-gmap #map [options]="mapOptions" [style]="{'width':'100%','height':'100%'}" [overlays]="gMapOverlays"
                (onMapClick)="handleMapClick($event)" (onOverlayDragEnd)="handleDragEnd($event)"></p-gmap>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div [hidden]="!tabs.timeSettings.active" style="height: 95%;padding-top: 5px;">
      <div class="row" style="margin-right: 0px;height: 100%">
        <div class="col-md-12" style="padding-right: 0px;height: 100%">
          <ul class="nav nav-tabs">
            <li (click)="selectSubTab('workingHours')" [class.active]="subTabs.workingHours.active"
              style="cursor: pointer;">
              <a style="color: black"><i class="fa fa-clock-o"></i> {{getCurrentLabelValue('lblWorkingHours')}}</a>
            </li>
            <li (click)="selectSubTab('specialDays')" [class.active]="subTabs.specialDays.active"
              style="cursor: pointer;">
              <a style="color: black;"><i class="fa fa-calendar"></i> {{getCurrentLabelValue('lblSpecialDays')}}</a>
            </li>
          </ul>
          <div [hidden]="!subTabs.workingHours.active" style="height: 95%;overflow-x: auto;padding-top: 5px;">
            <bf-working-hours [workingHours]="workingHours" (selectTimeSlot)="onUpdateWorkingHours($event)">
            </bf-working-hours>
          </div>
          <div [hidden]="!subTabs.specialDays.active" style="height: 95%;padding-top: 5px;">
            <!-- <p-schedule *ngIf="getCurrentCalendarLocale() === calendarLocale_EN" [locale]="calendarLocale_EN" [events]="specialDays"
              [height]="auto" [editable]="true" [aspectRatio]="3.2" (onDayClick)="onDayClick($event)" (onEventClick)="onEventClick($event)"
              (onEventDrop)="onEventDrop($event)" [header]="calendarOptions"></p-schedule>
            <p-schedule *ngIf="getCurrentCalendarLocale() === calendarLocale_RO" [locale]="calendarLocale_RO" [events]="specialDays"
              [height]="auto" [editable]="true" [aspectRatio]="3.2" (onDayClick)="onDayClick($event)" (onEventClick)="onEventClick($event)"
              (onEventDrop)="onEventDrop($event)" [header]="calendarOptions"></p-schedule> -->

            <!-- <p-schedule [events]="specialDays"
              [height]="auto" [editable]="true" [aspectRatio]="3.2" (onDayClick)="onDayClick($event)" (onEventClick)="onEventClick($event)"
              (onEventDrop)="onEventDrop($event)" [header]="calendarOptions"></p-schedule> -->
            <bf-full-calendar [events]="specialDays" (dateClick)="onDayClick($event)"
              (eventClick)="onEventClick($event)" (eventDrop)="onEventDrop($event)"></bf-full-calendar>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<p-dialog header="{{selectedDate==null ? '' : (selectedDate | date:'dd.MMM.yyyy')}}" [(visible)]="displayDialog"
  [responsive]="true" showEffect="fade" [modal]="false" width="700" height="600">
  <div style="width: 650px;height: 450px;overflow: auto">
    <bf-working-hours [workingHours]="specialDayWorkingHours" [singleDay]="selectedWeekDayIndex"
      (selectTimeSlot)="onUpdateWorkingHoursSpecialDay($event)"></bf-working-hours>
  </div>
  <footer>
    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
      <input type="button" [value]="getCurrentLabelValue('lblDelete')" class="btn btn-danger"
        (click)="removeSpecialDay()">
      <input type="button" [value]="getCurrentLabelValue('lblSave')" class="btn btn-success" (click)="saveSpecialDay()">
      <p-checkbox binary="true" label="{{getCurrentLabelValue('lblRepeatEveryYear')}}" [(ngModel)]="isRepeatEveryYear">
      </p-checkbox>
    </div>
  </footer>
</p-dialog>

<p-dialog [(visible)]="displayImageDialog" [responsive]="true" showEffect="fade" [modal]="false" width="600"
  height="500">
  <img *ngIf="selectedImage!=null" [src]="'data:image/png;base64,'+selectedImage.img"
    style="height: auto;width: auto;max-height: 450px!important;max-width: 550px!important;">
  <footer>
    <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
      <button type="button" [value]="" class="btn btn-danger" (click)="deleteImage()">
        <i class="fa fa-remove"></i> {{getCurrentLabelValue('lblDelete')}}
      </button>
    </div>
  </footer>
</p-dialog>

<p-dialog header="Affected Bookings" [(visible)]="displayAffectedBookings" [responsive]="true" showEffect="fade"
  [modal]="true" width="900">
  <bf-booking-management-dialog [idCompany]="idCompany" [bookings]="affectedBookings"
    (bookingRemoved)="onBookingRemoved($event)"></bf-booking-management-dialog>
</p-dialog>

<p-growl [value]="pageMsgs"></p-growl>